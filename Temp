payload = json.dumps(
    {
        "prompt": prompt,
        "output": self.inline_refs(schema),
        "stream": False,
    }
)

# Save the payload
import uuid, os
uuid_str = str(uuid.uuid4())
output_dir = "payload_logs"
os.makedirs(output_dir, exist_ok=True)
output_path = os.path.join(output_dir, f"{uuid_str}.json")
with open(output_path, "w") as f:
    f.write(payload)
