{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Selected Checkboxes",
  "description": "List of all checkboxes that are marked on the form.",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "checkboxes": {
      "type": "array",
      "description": "One object per selected checkbox.",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "context": {
            "type": "string",
            "enum": ["question", "table", "not_defined"],
            "description": "Location of the checkbox: a standalone question line or a table cell."
          },
          "row_label": {
            "type": ["string", "null"],
            "description": "Row header or index if context = 'table', otherwise null."
          },
          "column_label": {
            "type": ["string", "null"],
            "description": "Column header or index if context = 'table', otherwise null."
          },
          "question": {
            "type": ["string", "null"],
            "description": "Full question text if context = 'question', otherwise null."
          },
          "answer": {
            "type": ["string", "null"],
            "description": "Answer label beside the checkbox if context = 'question' or 'not_defined', otherwise null."
          }
        },
        "required": ["context", "answer"],
        "allOf": [
          {
            "if": { "properties": { "context": { "const": "table" } } },
            "then": { "required": ["row_label", "column_label"] }
          },
          {
            "if": { "properties": { "context": { "const": "question" } } },
            "then": { "required": ["question"] }
          }
        ]
      }
    }
  },
  "required": ["checkboxes"]
}
