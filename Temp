from itertools import groupby
from operator  import itemgetter

def order_rows(json_rows: list[dict]) -> list[dict]:
    """
    Return the rows ordered first by session_id, then by question.
    Assumes each row looks like {'session_id': 'session_003',
                                 'question'  : 'What is ...',
                                 'file'      : '...pdf'}
    """
    # 1) sort by session_id then question text
    json_rows.sort(key=lambda r: (r["session_id"], r["question"]))

    # 2) flatten back â€“ groupby here is optional, but shows the intent
    ordered = []
    for _sid, rows in groupby(json_rows, key=itemgetter("session_id")):
        ordered.extend(rows)           # keeps original (sorted) order
    return ordered
